
varying vec2 v_texCoord;
varying vec3 v_normal;
varying vec2 v_screenPos;
varying vec2 v_prevScreenPos;
uniform vec2 u_id;
uniform sampler2D mainTexture;
uniform sampler2D cornerTexture;
uniform vec3 u_addColor;

#include "utils.inc"

void main()
{	
    vec4 mainColor = texture2D(mainTexture, v_texCoord);
    float cornerMask = texture2D(cornerTexture, v_texCoord).r / 2;
    
    vec3 albedo = mainColor.rgb + u_addColor;
    albedo = mix(albedo, vec3(1, 0, 0), cornerMask);
    
    vec2 velocity = v_screenPos - v_prevScreenPos;
    outputGBuffer(albedo, v_normal, u_id, velocity);
}
