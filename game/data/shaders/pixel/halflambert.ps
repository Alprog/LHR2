
varying vec2 v_texCoord;

uniform sampler2D albedoTexture;
uniform sampler2D normalTexture;
uniform sampler2D shadowTexture;
uniform sampler2D wrapTexture;
uniform vec3 lightPosition;

void main()
{	
    vec4 albedo = texture2D(albedoTexture, v_texCoord);
    vec3 normal = texture2D(normalTexture, v_texCoord).rgb * 2 - 1;
    float shadow = texture2D(shadowTexture, v_texCoord).r;
    
    vec3 lightDir = normalize(lightPosition);
    
    float d = dot(normal, lightDir) / 2 + 0.49;
    vec4 diffuse = texture2D(wrapTexture, vec2(d, 0));
    vec4 color = albedo * diffuse * shadow;
    
    gl_FragColor = color;
}


    