
uniform sampler2D texture1;
uniform sampler2D texture2;
uniform float blendFactor;
uniform float opacity;
uniform float saturation;

varying vec2 v_texCoord1;
varying vec2 v_texCoord2;
varying vec4 v_color;

void main()
{	
	vec4 tex1 = texture2D(texture1, v_texCoord1);
	vec4 tex2 = texture2D(texture2, v_texCoord2);
	
	vec4 tex = tex1 * (1.0 - blendFactor) + tex2 * blendFactor;

	float a1 = v_color.a;
	float a2 = clamp(v_texCoord2.y * 10.0, 0.0, 1.0);
	tex.a = a1 * a2 * opacity;

	float g = tex.r * 0.3 + tex.g * 0.59 + tex.b * 0.11;
	vec3 gray = vec3(g, g, g);
	tex.rgb = mix(gray, tex.rgb, saturation); 
	
	gl_FragColor = tex;
}
